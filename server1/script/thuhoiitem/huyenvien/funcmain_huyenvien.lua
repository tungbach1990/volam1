  StartTimeGenItem = 1281891600
  EndTimeGenItem  = 1282093200
  Task_Limit_Do = 2724
  tbHuyenVien=
  {
  		{szName = "HuyÒn Viªn TrÝ TuÖ Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Viªn M·n PhËt Ch©u", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Viªn M·n Yªu §¸i", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn Viªn M·n Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Viªn M·n T¨ng Hµi", tbProp = {0, 5, 0}},	
		{szName = "HuyÒn Viªn PhËt T©m H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn PhËt T©m Hé UyÓn", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn PhËt T©m Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn PhËt T©m Yªu §¸i", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn Xung Thiªn Yªu §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn Xung Thiªn Kh¶i", tbProp = {0, 2, 4}},	
		{szName = "HuyÒn Viªn Xung Thiªn Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Xung Thiªn H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Phi V©n Yªu §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn Phi V©n Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Phi V©n Ngoa", tbProp = {0, 5, 0}},	
		{szName = "HuyÒn Viªn Anh Dòng Kh«i", tbProp = {0, 7, 4}},	
		{szName = "HuyÒn Viªn Anh Dòng H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn TÞnh ¢m Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn TÞnh ¢m H­¬ng Nang", tbProp = {0, 9, 0}},	
		{szName = "HuyÒn Viªn TÞnh ¢m Hé UyÓn", tbProp = {0, 8, 0}},	
		{szName = "HuyÒn Viªn TÞnh ¢m Ch©u Liªn", tbProp = {0, 4, 0}},	
		{szName = "HuyÒn Viªn Hµn B¨ng Thóc Yªu", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn Hµn B¨ng Ch©u Liªn", tbProp = {0, 4, 0}},	
		{szName = "HuyÒn Viªn Hµn B¨ng Hµi", tbProp = {0, 5, 3}},	
		{szName = "HuyÒn Viªn Hµn B¨ng H­¬ng Nang", tbProp = {0, 9, 0}},	
		{szName = "HuyÒn Viªn NguyÖt Hoa H­¬ng Nang", tbProp = {0, 9, 0}},	
		{szName = "HuyÒn Viªn NguyÖt Hoa Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn NguyÖt Hoa Tô", tbProp = {0, 8, 0}},	
		{szName = "HuyÒn Viªn NguyÖt Hoa Ch©u Liªn", tbProp = {0, 4, 0}},	
		{szName = "HuyÒn Viªn Phån Hoa Ch©u Liªn", tbProp = {0, 4, 0}},	
		{szName = "HuyÒn Viªn §o¹n Tr­êng H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn §o¹n Tr­êng Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn §o¹n Tr­êng BÝ Trang", tbProp = {0, 2, 2}},	
		{szName = "HuyÒn Viªn §o¹n Tr­êng Yªu §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn HuyÕt S¸t H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn HuyÕt S¸t Yªu §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn HuyÕt S¸t Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn HuyÕt S¸t BÝ Trang", tbProp = {0, 2, 2}},	
		{szName = "HuyÒn Viªn L·nh T©m TriÒn Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn L·nh T©m Gi¸p Y", tbProp = {0, 2, 3}},	
		{szName = "HuyÒn Viªn L·nh T©m H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn L·nh T©m Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn V« T×nh Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn V« T×nh Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn V« T×nh H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn V« T×nh Lý", tbProp = {0, 5, 1}},	
		{szName = "HuyÒn Viªn Hµn Quang Lý", tbProp = {0, 5, 1}},	
		{szName = "HuyÒn Viªn Hµn Quang Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn Hµn Quang Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Hµn Quang Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn D­¬ng C­¬ng Ngoa", tbProp = {0, 5, 0}},	
		{szName = "HuyÒn Viªn D­¬ng C­¬ng Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn D­¬ng C­¬ng H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn D­¬ng C­¬ng Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn ChiÕn Long Yªu Trôy", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn ChiÕn Long Thóc Yªu", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn ChiÕn Long Hé UyÓn", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn ChiÕn Long H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn L¹c Hån Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn L¹c Hån Yªu §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn L¹c Hån Hé UyÓn", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn L¹c Hån H¹ng Khuyªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Ch­íc T×nh Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Ch­íc T×nh Hé UyÓn", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn Ch­íc T×nh Qu¸n MiÖn", tbProp = {0, 7, 2}},	
		{szName = "HuyÒn Viªn Ch­íc T×nh H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Tam Phong Lý", tbProp = {0, 5, 0}},	
		{szName = "HuyÒn Viªn Tam Phong Ngäc Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Tam Phong Ph¸p §¸i", tbProp = {0, 6, 1}},	
		{szName = "HuyÒn Viªn Tam Phong Phï", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Tu T©m Ngäc Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Tu T©m Tô", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn Tu T©m Phï", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Tu T©m Ph¸p §¸i", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn Xuyªn V©n Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Xuyªn V©n H¹ng Liªn", tbProp = {0, 4, 1}},	
		{szName = "HuyÒn Viªn Xuyªn V©n Hé UyÓn", tbProp = {0, 8, 1}},	
		{szName = "HuyÒn Viªn Xuyªn V©n Yªu §¸i", tbProp = {0, 6, 0}},	
		{szName = "HuyÒn Viªn Ph¸ B¨ng Béi", tbProp = {0, 9, 1}},	
		{szName = "HuyÒn Viªn Ph¸ B¨ng Thñ", tbProp = {0, 8, 1}},
  };

 
function  ThuHoiHuyenVien_main(nItemIndex)
	
	if (IsActiveTime()~=1) then
		Talk(1,"","Chøc n¨ng t¹m ®ãng !")
		return
	end
	if (GetTask(Task_Limit_Do) >= 4) then
		Talk(1,"","ChØ cã thÓ ®æi tèi ®a 4 lÇn")
		return
	end
	GiveItemUI( "Thu håi trang bÞ HuyÒn Viªn", "§Æt vµo vËt phÈm HuyÒn Viªn", "ConfirmTask", "no",1 );
end

function ConfirmTask(nCount)
	--Msg2Player("Callll")
	if (nCount ~= 1) then
		Talk(1,"","Mçi lÇn chØ thu håi mét vËt phÈm !")
		return
	end
	local nItemIdx = GetGiveItemUnit(1);
	local nG, nD, nP = GetItemProp(nItemIdx)
	local strItemName = GetItemName(nItemIdx)
	for i=1,getn(tbHuyenVien) do
		local nGen = tbHuyenVien[i].tbProp[1]
		local nDet = tbHuyenVien[i].tbProp[2]
		local nPar = tbHuyenVien[i].tbProp[3]
		local szItemName = tbHuyenVien[i].szName
		if (nGen == nG and nDet == nD and nPar == nP) then
			if (szItemName == strItemName) then
				local nTime = GetItemGenTime(nItemIdx)
				if (CheckTimeGenItem(nTime)==1) then
					SetTask(Task_Limit_Do,GetTask(Task_Limit_Do)+1)
					RemoveItemByIndex(nItemIdx)
					AddEnergy(46000)
					
					Msg2Player("B¹n võa tr¶ l¹i trang bÞ "..szItemName)
					Msg2Player("B¹n võa nhËn l¹i 46000 ®iÓm tinh lùc, xin kiÓm tra l¹i !")
					WriteLog(date("%Y%m%d %H%M%S").."\t".."Thu Håi Item HuyÒn Viªn"..GetAccount().."\t"..GetName().."\t".."tr¶ l¹i vËt phÈm "..szItemName)
					return
				else
					Talk(1,"","Ta chØ nhËn l¹i trang bÞ HuyÒn Viªn ®æi ra 6 giê 16-8-2010 ®Õn 8 giê 18-08-2010")
					return
				end
			end
		end
	end--for
	Talk(1,"","Ta chØ nhËn nhËn l¹i trang bÞ HuyÒn Viªn ®æi ra trong kho¶ng thêi gian tõ  6 giê 16-8-2010 ®Õn 8 giê 18-08-2010 !")
end

function CheckTimeGenItem(nTimeGenItem)
	if (nTimeGenItem >= StartTimeGenItem and nTimeGenItem <= EndTimeGenItem) then
		return 1
	end
	return 0
end

function IsActiveTime()
	local nDate = tonumber(GetLocalDate("%Y%m%d"))
	if (nDate <= 20100905) then
		return 1
	end
	return 0
end

function no()
end