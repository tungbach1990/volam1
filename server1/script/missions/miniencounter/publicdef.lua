IncludeLib("TITLE");
DungeonGlobalData = {};

DungeonGlobalData.BATTLE_NAME						= "Phï Li Xung §ét ChiÕn";			 -- Õ½ÒÛÃû³Æ
DungeonGlobalData.MAP_WAIT_TIME					  = 180					  -- ±ÈÈü×¼±¸Ê±¼ä£ºXÃë
DungeonGlobalData.MAP_FIGHT_TIME					 = 1800;					 -- ±ÈÈü¾º¼¼Ê±¼ä£ºXÃë
--DungeonGlobalData.MAP_FIGHT_TIME				   = 180;					  -- ±ÈÈü¾º¼¼Ê±¼ä£ºXÃë
DungeonGlobalData.MAP_WAIT_COUNT_SECOND			  = 10;					   -- ±ÈÈüµ¹ÊýÊ±¼ä£ºXÃë
DungeonGlobalData.MAP_REBORN_TIME					= 3;						-- ËÀÍöÖØÉúÊ±¼ä£ºXÃë
DungeonGlobalData.BLACK_LIST_TIME					= 10;					   -- ºÚÃûµ¥Ê±¼ä£ºX·ÖÖÓ
DungeonGlobalData.MAP_WIN_SCORE					  = 15;					   -- Ó®µÃ±ÈÈüÒªÇóµÄ·ÖÊý
--DungeonGlobalData.MAP_WIN_SCORE					= 4;						-- Ó®µÃ±ÈÈüÒªÇóµÄ·ÖÊý
DungeonGlobalData.WINNER_EXPLOIT_VALUE_BASE		  = 150;					  -- Ê¤ÀûÕóÓª¹¦Ñ«»ùÊý
DungeonGlobalData.LOSER_EXPLOIT_VALUE_BASE		   = 60;					   -- Ê§°ÜÕóÓª¹¦Ñ«»ùÊý

DungeonGlobalData.PLAYER_POINTS_TASK_VALUE		   = 3449;					 -- ·ûÀë³åÍ»Õ½¸öÈË»ý·ÖÈÎÎñ±äÁ¿
DungeonGlobalData.PLAYER_EXPLOIT_TASK_VALUE		  = 3450;					 -- ·ûÀë³åÍ»Õ½¸öÈË¹¦Ñ«ÈÎÎñ±äÁ¿
DungeonGlobalData.PLAYER_EXPLOIT_PER_WEEK_TASK_VALUE = 3473;					 -- ·ûÀë³åÍ»Õ½¸öÈËÃ¿ÖÜ×Ü¹¦Ñ«ÈÎÎñ±äÁ¿
DungeonGlobalData.PLAYER_WEEK_EXPLOIT_TIME_TASK	  = 3474;					 -- ¼ÇÂ¼×î½üÒ»´Î»ñµÃ¹¦Ñ«µÄÖÜÊý
DungeonGlobalData.PLAYER_HISTORY_EXPLOIT_TASK_VALUE  = 3452;					 -- ·ûÀë³åÍ»Õ½¸öÈËÀúÊ·¹¦Ñ«×ÜºÍÈÎÎñ±äÁ¿
DungeonGlobalData.BROKEN_MEDAL_USE_PER_WEEK		  = 3453;					 -- ÆÆËéµÄËÎ½ðÑ«ÕÂÃ¿ÖÜÊ¹ÓÃ¸öÊý
DungeonGlobalData.COMPLETE_MEDAL_USE_PER_WEEK		= 3454;					 -- ÍêÕûµÄËÎ½ðÑ«ÕÂÃ¿ÖÜÊ¹ÓÃ¸öÊý

DungeonGlobalData.PLAYER_LEVEL_LIMIT				 = 120;					  -- 120¼¶»ò×ªÉúÍæ¼Ò
DungeonGlobalData.MAX_EXPLOIT_VALUE				  = 3500;					 -- ¹¦Ñ«ÖµÉÏÏÞ

DungeonGlobalData.SCORE_KILL_MIDDLE_PILLAR		   = 2;						-- ¿³shiÖÐ¼äÁúÆì»ñµÃµÄ·ÖÊý

DungeonGlobalData.TASK_SCORE_TOTAL				   = 3457;					 -- Íæ¼ÒÎª¼º·½¶áÈ¡»ý·ÖÊý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_KILL_ENEMY_NUM				= 3458;					 -- Íæ¼ÒÉ±µÐÍæ¼ÒÊý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_KILL_MIDDLE_PILLAR_NUM		= 3459;					 -- Íæ¼Ò¶áµÃÁúÆìÊý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_KILL_ENEMY_PILLAR_NUM		 = 3460;					 -- Íæ¼ÒÕ¶µÐË§ÆìÊý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_GET_ENEMY_BUFF_NUM			= 3461;					 -- Íæ¼Ò¶áµÐÕä±¦Êý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_CUR_KILL_COMBO_NUM			= 3462;					 -- Íæ¼Òµ±Ç°Á¬Õ¶Êý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_CUR_TITLE_INDEX			   = 3463;					 -- Íæ¼ÒÕ½¹¦¾üÏÎË÷Òý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_DEATH_TOTAL_NUM			   = 3464;					 -- Íæ¼ÒËÀÍö´ÎÊý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_MAX_KILL_COMBO_NUM			= 3465;					 -- Íæ¼Ò×î´óÁ¬Õ¶Êý(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_PERSONAL_SCORE				= 3466;					 -- Íæ¼Ò¸öÈË»ý·Ö(¸öÈËÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_FINISH_TIME			= 3467;					 -- Õ½³¡½áÊøµÄÊ±¼ä(µØÍ¼ÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_SONG_NUM			   = 3468;					 -- ËÎ·½ÔÚ³¡ÈËÊý(µØÍ¼ÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_JIN_NUM				= 3469;					 -- ½ð·½ÔÚ³¡ÈËÊý(µØÍ¼ÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_SONG_SCORE			 = 3470;					 -- ËÎ·½·ÖÊý(µØÍ¼ÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_JIN_SCORE			  = 3471;					 -- ½ð·½·ÖÊý(µØÍ¼ÐÅÏ¢)
DungeonGlobalData.TASK_BATTLE_PLAYER_CAMP			= 3472;					 -- Íæ¼ÒÕóÓª(¸öÈËÐÅÏ¢)

DungeonGlobalData.tbCampName = 
{
	[1] = "Tèng",
	[2] = "Kim",
};

-- ±¨ÃûÒÔ¼°µÈ´ý¿ªÊ¼µÄºÏ·¨µØÍ¼
DungeonGlobalData.tbLegalPrepareMapList =
{
	[1]   = " Ph­îng T­êng"  ,
	[11]  = " Thµnh §«"  ,
	[37]  = " BiÖn Kinh"  ,
	[80]  = " D­¬ng Ch©u"  ,
	[78]  = " T­¬ng D­¬ng"  ,
	[162] = " §¹i Lý "  ,
	[176] = " L©m An"  ,
	[20]  = "Giang T©n Th«n",
	[53]  = "Ba L¨ng huyÖn",
	[54]  = "Nam Nh¹c trÊn",
	[99]  = "VÜnh L¹c trÊn",
	[100] = "Chu Tiªn trÊn",
	[101] = "§¹o H­¬ng th«n",
	[121] = "Long M«n trÊn",
	[153] = "Th¹ch Cæ trÊn",
	[174] = "Long TuyÒn th«n",
	[325] = "§iÓm b¸o danh Tèng Kim",
};

-- ·ûÀë³åÍ»Õ½¿ª·ÅÊ±¼ä
DungeonGlobalData.tbActivityTime =
{
	[1] = {9, 23},
};

-- ·ÇÕ½¶·NPCÎ»ÖÃÐÅÏ¢£º´¢ÎïÏä£¬Ò©ÉÌ
DungeonGlobalData.tbNonFightNpcPos = 
{
	[1] = 
	{
		szName	   = "R­¬ng chøa ®å",
		nPosX		= 52096,
		nPosY		= 109920,
		nNpcId	   = 625,
		szScriptPath = "\\script\\battles\\openbox.lua",
	},	
	[2] = 
	{
		szName	   = "R­¬ng chøa ®å",
		nPosX		= 59488,
		nPosY		= 99328,
		nNpcId	   = 625,
		szScriptPath = "\\script\\battles\\openbox.lua",
	},
	[3] = 
	{
		szName	   = "Chñ d­îc ®iÕm",
		nPosX		= 51872, 
		nPosY		= 109440,
		nNpcId	   = 203,
		szScriptPath = "\\script\\missions\\arena\\npc\\yaodian.lua",
	},
	[4] = 
	{
		szName	   = "Chñ d­îc ®iÕm",
		nPosX		= 59840, 
		nPosY		= 99712,
		nNpcId	   = 203,
		szScriptPath = "\\script\\missions\\arena\\npc\\yaodian.lua",
	},
};

--DungeonGlobalData.tbBattleReplenishNpc = 
--{
--	[1] = 
--	{
--		szName	   = "Õ½³¡²¹¸øÉÌ",
--		nPosX		= 49568, 
--		nPosY		= 101376,
--		nNpcId	   = 2068,
--		szScriptPath = "\\script\\missions\\arena\\npc\\yaodian.lua",
--	},
--	[2] = 
--	{
--		szName	   = "Õ½³¡²¹¸øÉÌ",
--		nPosX		= 50112, 
--		nPosY		= 99040,
--		nNpcId	   = 2068,
--		szScriptPath = "\\script\\missions\\arena\\npc\\yaodian.lua",
--	},
--};

-- Õ½¶·NPCÎ»ÖÃÐÅÏ¢£ºÊ¿±ø
DungeonGlobalData.tbFightNpcPos = 
{
	-- ËÎ·½Õ½¶·NPCÎ»ÖÃ
	[1] = 
--	{
--		{1659, 3382}, {1656, 3386}, {1652, 3389}, {1663, 3397}, {1164, 3392}, {1669, 3388}, {1699, 3346}, {1701, 3343},
--		{1704, 3339}, {1706, 3336}, {1704, 3333}, {1701, 3334}, {1760, 3354}, {1755, 3354}, {1757, 3359}, {1755, 3363},
--		{1753, 3361}, {1751, 3359}, {1644, 3296}, {1646, 3299}, {1647, 3302}, {1644, 3304}, {1642, 3302}, {1639, 3302},
--		{1721, 3303}, {1719, 3307}, {1715, 3308}, {1713, 3306}, {1712, 3301}, {1714, 3289}, {1741, 3266}, {1743, 3269},
--		{1745, 3273}, {1741, 3276}, {1738, 3273}, {1735, 3270}, {1669, 3355}, {1670, 3357}, {1673, 3359}, {1674, 3364},
--		{1672, 3365}, {1669, 3368},
--	},
	{
		{1667, 3371}, {1663, 3379}, {1653, 3388}, {1659, 3393}, {1662, 3394}, {1666, 3390}, {1670, 3356}, {1672, 3358}, 
		{1674, 3359}, {1673, 3364}, {1676, 3360}, {1676, 3363}, {1700, 3336}, {1703, 3334}, {1705, 3333}, {1705, 3338},
		{1704, 3339}, {1708, 3334}, {1717, 3304}, {1719, 3306}, {1718, 3309}, {1737, 3263}, {1739, 3265}, {1743, 3268},
		{1746, 3267}, {1746, 3273}, {1739, 3360}, {1766, 3228}, {1768, 3229}, {1769, 3225}, {1778, 3193}, {1779, 3191},
		{1781, 3187}, {1785, 3187}, {1787, 3189}, {1792, 3193}, {1813, 3164}, {1816, 3166}, {1830, 3227}, {1833, 3228},
		{1836, 3226}, {1835, 3216}, {1839, 3218}, {1835, 3213}, {1733, 3193}, {1735, 3184}, {1734, 3188}, {1733, 3195},
	},
	-- ½ð·½Õ½¶·NPCÎ»ÖÃ
	[2] = 
--	{
--		{1835, 3134}, {1837, 3141}, {1841, 3147}, {1836, 3152}, {1838, 3152}, {1825, 3152}, {1806, 3169}, {1808, 3172},
--		{1807, 3177}, {1804, 3175}, {1806, 3182}, {1803, 3180}, {1784, 3199}, {1781, 3200}, {1779, 3198}, {1782, 3190},
--		{1784, 3188}, {1784, 3190}, {1763, 3223}, {1764, 3229}, {1764, 3232}, {1761, 3231}, {1765, 3236}, {1744, 3248},
--		{1746, 3251}, {1748, 3254}, {1747, 3255}, {1750, 3259}, {1744, 3254}, {1728, 3185}, {1731, 3185}, {1730, 3190},
--		{1727, 3189}, {1724, 3191}, {1726, 3195}, {1830, 3219}, {1833, 3221}, {1832, 3224}, {1829, 3225}, {1834, 3226},
--		{1837, 3223}, {1782, 3194}, 
--	},
	{
		{1825, 3145}, {1828, 3141}, {1836, 3139}, {1840, 3145}, {1839, 3151}, {1834, 3152}, {1808, 3168}, {1809, 3172},
		{1808, 3176}, {1806, 3175}, {1802, 3175}, {1806, 3177}, {1790, 3191}, {1791, 3194}, {1790, 3197}, {1782, 3194},
		{1788, 3199}, {1789, 3194}, {1762, 3224}, {1765, 3227}, {1766, 3230}, {1743, 3247}, {1745, 3254}, {1746, 3255},
		{1746, 3260}, {1747, 3265}, {1745, 3267}, {1738, 3265}, {1723, 3299}, {1721, 3305}, {1720, 3308}, {1706, 3327},
		{1707, 3330}, {1707, 3335}, {1707, 3339}, {1707, 3342}, {1709, 3338}, {1672, 3353}, {1675, 3353}, {1641, 3304},
		{1643, 3306}, {1645, 3303}, {1762, 3355}, {1761, 3360}, {1759, 3363}, {1757, 3364}, {1753, 3364}, {1751, 3362},
	},
};

-- Õ½¶·NPCÎ»ÖÃÐÅÏ¢£ºÕ½Æì
DungeonGlobalData.tbPillarNpcPos = 
{
	-- ËÎ·½Öù×ÓNpcÎ»ÖÃ
	[1] = 
	{
		{1661, 3389},
	},
	-- ½ð·½Öù×ÓNpcÎ»ÖÃ
	[2] =
	{
		{1835, 3145},
	},
	-- ÖÐÑëÖù×ÓNpcÎ»ÖÃ
	[3] =
	{
		{1743, 3264},
	},
};

-- Õ½¶·NPCÐÅÏ¢£ºÊ¿±ø
DungeonGlobalData.tbFightNpcInfo = 
{
	-- ËÎ·½Õ½¶·NPCÐÅÏ¢
	[1] = 
	{
		[1] = { szName  = "Tèng binh", nLevel  = 100, nNpcId  = 2025, nIsBoss = 0, nRate = 86, },
		[2] = { szName  = "Tèng HiÖu óy", nLevel  = 100, nNpcId  = 2026, nIsBoss = 0, nRate = 8,  },
		[3] = { szName  = "Tèng Thèng lÜnh", nLevel  = 100, nNpcId  = 2027, nIsBoss = 0, nRate = 3,  },
		[4] = { szName  = "Tèng Phã t­íng", nLevel  = 100, nNpcId  = 2028, nIsBoss = 0, nRate = 2,  },
		[5] = { szName  = "Tèng §¹i t­íng", nLevel  = 100, nNpcId  = 2029, nIsBoss = 0, nRate = 1,  },
	},
	-- ½ð·½Õ½¶·NPCÐÅÏ¢
	[2] = 
	{
		[1] = { szName  = "Kim binh", nLevel  = 100, nNpcId  = 2031, nIsBoss = 0, nRate = 86, },
		[2] = { szName  = "Kim HiÖu óy", nLevel  = 100, nNpcId  = 2032, nIsBoss = 0, nRate = 8,  },
		[3] = { szName  = "Kim Thèng LÜnh", nLevel  = 100, nNpcId  = 2033, nIsBoss = 0, nRate = 3,  },
		[4] = { szName  = "Kim Phã t­íng", nLevel  = 100, nNpcId  = 2034, nIsBoss = 0, nRate = 2,  },
		[5] = { szName  = "Kim §¹i t­íng", nLevel  = 100, nNpcId  = 2035, nIsBoss = 0, nRate = 1,  },
	},
};

DungeonGlobalData.tbSoldierDropBuff = 
{
	["Tèng binh"] = {nRate = 1, nTimes = 1, },
	["Kim binh"] = {nRate = 1, nTimes = 1, },

	["Tèng HiÖu óy"] = {nRate = 10, nTimes = 2, },
	["Kim HiÖu óy"] = {nRate = 10, nTimes = 2, },

	["Tèng Thèng lÜnh"] = {nRate = 30, nTimes = 3, },
	["Kim Thèng LÜnh"] = {nRate = 30, nTimes = 3, },

	["Tèng Phã t­íng"] = {nRate = 60, nTimes = 4, },
	["Kim Phã t­íng"] = {nRate = 60, nTimes = 4, },

	["Tèng §¹i t­íng"] = {nRate = 100, nTimes = 5, },
	["Kim §¹i t­íng"] = {nRate = 100, nTimes = 5, },
};

-- Õ½¶·NPCÐÅÏ¢£ºÕ½Æì
DungeonGlobalData.tbPillarNpcInfo = 
{
	-- ËÎ·½Öù×ÓNpcÐÅÏ¢
	[1] = 
	{
		[1]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2037, nIsBoss = 1, },   -- Éè³ÉbossÓÐ¹â»·
		[2]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2038, nIsBoss = 1, },
		[3]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2039, nIsBoss = 1, },
		[4]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2040, nIsBoss = 1, },
		[5]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2041, nIsBoss = 1, },
		[6]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2042, nIsBoss = 1, },
		[7]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2043, nIsBoss = 1, },
		[8]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2044, nIsBoss = 1, },
		[9]  = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2045, nIsBoss = 1, },
		[10] = { szName  = "Cê Nguyªn So¸i phe Tèng", nLevel  = 100, nNpcId  = 2046, nIsBoss = 1, },
	},
	-- ½ð·½Öù×ÓNpcÐÅÏ¢
	[2] =
	{
		[1]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2047, nIsBoss = 1, },
		[2]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2048, nIsBoss = 1, },
		[3]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2049, nIsBoss = 1, },
		[4]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2050, nIsBoss = 1, },
		[5]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2051, nIsBoss = 1, },
		[6]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2052, nIsBoss = 1, },
		[7]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2053, nIsBoss = 1, },
		[8]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2054, nIsBoss = 1, },
		[9]  = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2055, nIsBoss = 1, },
		[10] = { szName  = "Cê Nguyªn So¸i phe Kim", nLevel  = 100, nNpcId  = 2056, nIsBoss = 1, },
	},
	-- ÖÐÑëÖù×ÓNpcÎ»ÖÃ
	[3] =
	{
		[1]  = { szName  = "Cê Rång", nLevel  = 100, nNpcId  = 2057, nIsBoss = 1, },
	},
};

-- Õ½³¡¸öÈË»ý·Ö³ÆºÅÐÅÏ¢
DungeonGlobalData.tbBattleTitle = 
{
	-- ËÎ·½³ÆºÅÐÅÏ¢
	[1] = 
	{
		[1] = {"Binh sÜ phe Tèng", 306},
		[2] = {"HiÖu óy phe Tèng", 307},
		[3] = {"Thèng lÜnh phe Tèng", 308},
		[4] = {"Phã t­íng phe Tèng", 309},
		[5] = {"§¹i t­íng phe Tèng", 310},
	},
	-- ½ð·½³ÆºÅÐÅÏ¢
	[2] =
	{
		[1] = {"Binh sÜ phe Kim", 311},
		[2] = {"HiÖu óy phe Kim", 312},
		[3] = {"Thèng lÜnh phe Kim", 313},
		[4] = {"Phã t­íng phe Kim", 314},
		[5] = {"§¹i t­íng phe Kim", 315},
	},
};

-- Õ½³¡¸öÈË»ý·ÖµÈ¼¶ÐÅÏ¢£º¸ù¾Ý³ÆºÅÊýÄ¿»®·ÖÎªÎå¸öµÈ¼¶
DungeonGlobalData.tbBattleTitleLvInfo = 
{
	[1] = {0 , 20},
	[2] = {20, 38},
	[3] = {38, 54},
	[4] = {54, 68},
	[5] = {68, -1},
};

-- ÐÐºÅ£ºÉ±ÈËÕßµÄ³ÆºÅµÈ¼¶£¬ÁÐÊý£º±»É±ÕßµÄ³ÆºÅµÈ¼¶
DungeonGlobalData.tbIncreaseScore =
{
	[1] = {2, 4, 6, 8, 10},
	[2] = {0, 2, 4, 6, 8},
	[3] = {0, 0, 2, 4, 6},
	[4] = {0, 0, 1, 2, 4},
	[5] = {0, 0, 0, 1, 2},
};

-- ÐÐºÅ£ºÉ±ÈËÕßµÄ³ÆºÅµÈ¼¶£¬ÁÐÊý£º±»É±ÕßµÄ³ÆºÅµÈ¼¶
DungeonGlobalData.tbDecreaseScore =
{
	[1] = {0, 2, 3, 4, 5},
	[2] = {0, 1, 2, 3, 4},
	[3] = {0, 0, 1, 2, 3},
	[4] = {0, 0, 0, 1, 2},
	[5] = {0, 0, 0, 0, 1},
};

-- ÐÐºÅ£ºÉ±ÈËÕßµÄ³ÆºÅµÈ¼¶£¬ÁÐÊý£º±»É±ÕßµÄ³ÆºÅµÈ¼¶
DungeonGlobalData.tbValidCombo = 
{
	[1] = {1, 1, 1, 1, 1},
	[2] = {0, 1, 1, 1, 1},
	[3] = {0, 0, 1, 1, 1},
	[4] = {0, 0, 0, 1, 1},
	[5] = {0, 0, 0, 0, 1},
};

-- ¹¦Ñ«¼ÆËã¹«Ê½ÖÐFnÒò×Ó
DungeonGlobalData.tbFn = 
{
	[1] = -0.1,
	[2] = 0,
	[3] = 0.1,
	[4] = 0.3,
	[5] = 0.5,
};

DungeonGlobalData.tbBuff = 
{
	[1]  = {szName = "T¨ng Sinh lùc (%) "	, tbProp = {6, 1, 3534, 1, 0, 0}, nBuffID = 1298, },
	[2]  = {szName = "T¨ng Néi lùc (%) "	, tbProp = {6, 1, 3535, 1, 0, 0}, nBuffID = 1299, },
	[3]  = {szName = "Gi¶m thä th­¬ng"			, tbProp = {6, 1, 3536, 1, 0, 0}, nBuffID = 1300, },
	[4]  = {szName = "Gi¶m thêi gian tróng ®éc"			, tbProp = {6, 1, 3537, 1, 0, 0}, nBuffID = 1301, },
	[5]  = {szName = "Gi¶m thêi gian tr× ho·n"			, tbProp = {6, 1, 3538, 1, 0, 0}, nBuffID = 1302, },
	[6]  = {szName = "Gi¶m thêi gian cho¸ng"			, tbProp = {6, 1, 3539, 1, 0, 0}, nBuffID = 1303, },
	[7]  = {szName = "T¨ng kh¸ng hoµn toµn"			  , tbProp = {6, 1, 3540, 1, 0, 0}, nBuffID = 1304, },
	[8]  = {szName = "N©ng cao giíi h¹n m¸u trong cña b¶n th©n", tbProp = {6, 1, 3541, 1, 0, 0}, nBuffID = 1305, },
	[9]  = {szName = "T¨ng tèc ®é ch¹y"				, tbProp = {6, 1, 3542, 1, 0, 0}, nBuffID = 1306, },
	[10] = {szName = "T¨ng nÐ tr¸nh"				, tbProp = {6, 1, 3543, 1, 0, 0}, nBuffID = 1307, },
	[11] = {szName = "Hîp thµnh kÜ n¨ng c«ng kÝch"		  , tbProp = {6, 1, 3544, 1, 0, 0}, nBuffID = 1310, },
	[12] = {szName = "Hîp thµnh kÜ n¨ng c«ng kÝch"		  , tbProp = {6, 1, 3545, 1, 0, 0}, nBuffID = 1310, },
	[13] = {szName = "T¨ng tØ lÖ träng kÝch"			, tbProp = {6, 1, 3546, 1, 0, 0}, nBuffID = 1311, },
	[14] = {szName = "T¨ng tØ lÖ träng kÝch ®èi kh¸ng"		, tbProp = {6, 1, 3547, 1, 0, 0}, nBuffID = 1312, },
};

DungeonGlobalData.tbValidWaitMap = 
{
	[1] = {1  , 43 },
	[2] = {45 , 196},
	[3] = {198, 207},
	[4] = {224, 234},
	[5] = {319, 325},
	[6] = {332, 333},
	[7] = {340, 340},
};

DungeonGlobalData.tbGameServerInfo =
{
	[1] = 11,				   -- ³É¶¼
	[2] = 162,				  -- ´óÀí¸®
	[3] = 80,				   -- ÑïÖÝ
	[4] = 78,				   -- ÏåÑô
	[5] = 1,					-- ·ïÏè
	[6] = 37,				   -- ãê¾©
	[7] = 59,				   -- ÌìÍõ°ï
	[8] = 176,				  -- ÁÙ°²
};

function DungeonGlobalData:BubbleSort(t, func)
	local n = getn(t);
	for i = 1, n do
		for j = 1, n - i do
			if func(t[j], t[j + 1]) then
				t[j + 1], t[j] = t[j], t[j + 1];
			end
		end
	end
end

function DungeonGlobalData:IsInValidWaitMap(nMapId)
	print("[Function Stack] - DungeonGlobalData:IsInValidWaitMap(szRoleName) - publicdef.lua");

	local nValidWaitMapGroupNum = getn(DungeonGlobalData.tbValidWaitMap);
	for i = 1, nValidWaitMapGroupNum do
		local tbValidWaitMapInterval = DungeonGlobalData.tbValidWaitMap[i];
		if nMapId >= tbValidWaitMapInterval[1] and nMapId <= tbValidWaitMapInterval[2] then
			return 1;
		end
	end
	
	return
end

function DungeonGlobalData:CheckPlayerState()
	local nMapId = GetWorldPos()
	if not DungeonGlobalData:IsInValidWaitMap(nMapId) then
		print(">> Debug : player is in invalid map:"..nMapId);
		return nil;
	end

	if ST_GetOffliveState() == 1 or
	   GetOnlineCommissionStatus() == 1 or
	   GetStallState() == 1 then
	   return nil;
	end
	return 1;
end

function DungeonGlobalData:GetFnByTitle(nTitleLv)
	return DungeonGlobalData.tbFn[nTitleLv];
end

function DungeonGlobalData:GetIncreaseScorePoint(nKillerRank, nDeadthRank)
--	print("[Function Stack] - DungeonGlobalData:GetIncreaseScorePoint(nKillerRank, nDeadthRank) - publicdef.lua");
--	print(">> Debug : nKillerRank = "..nKillerRank);
--	print(">> Debug : nDeadthRank = "..nDeadthRank);
	
	if nKillerRank == nil or nDeadthRank == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank] == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank][nDeadthRank] == nil then
		return 0;
	end

	return DungeonGlobalData.tbIncreaseScore[nKillerRank][nDeadthRank];
end

function DungeonGlobalData:GetDecreaseScorePoint(nKillerRank, nDeadthRank)
--	print("[Function Stack] - DungeonGlobalData:GetDecreaseScorePoint(nKillerRank, nDeadthRank) - publicdef.lua");
--	print(">> Debug : nKillerRank = "..nKillerRank);
--	print(">> Debug : nDeadthRank = "..nDeadthRank);
	if nKillerRank == nil or nDeadthRank == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank] == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank][nDeadthRank] == nil then
		return 0;
	end

	return DungeonGlobalData.tbDecreaseScore[nKillerRank][nDeadthRank];
end

function DungeonGlobalData:GetValidCombo(nKillerRank, nDeadthRank)
--	print("[Function Stack] - DungeonGlobalData:GetValidCombo(nKillerRank, nDeadthRank) - publicdef.lua");
--	print(">> Debug : nKillerRank = "..nKillerRank);
--	print(">> Debug : nDeadthRank = "..nDeadthRank);
	if nKillerRank == nil or nDeadthRank == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank] == nil or
	   DungeonGlobalData.tbIncreaseScore[nKillerRank][nDeadthRank] == nil then
		return 0;
	end

	return DungeonGlobalData.tbValidCombo[nKillerRank][nDeadthRank];
end

-- ¸ù¾Ý¸öÈË»ý·Ö»ñÈ¡³ÆºÅµÈ¼¶
function DungeonGlobalData:ChooseTitleLv(nBattleScore)
	print("[Function Stack] - DungeonGlobalData:ChooseTitleLv(nBattleScore) - publicdef.lua");
	if nBattleScore == nil or nBattleScore < 0 then
		return 1;
	end

	local tbLvInfo = DungeonGlobalData.tbBattleTitleLvInfo;
	local nLvNum   = getn(tbLvInfo);
	for i = 1, nLvNum do
		if i == nLvNum and nBattleScore >= tbLvInfo[i][1] then
			return i;
		end

		if nBattleScore < tbLvInfo[i][2] and nBattleScore >= tbLvInfo[i][1] then
			return i;
		end
	end

	return 1;
end

function DungeonGlobalData:CreatePillarNpc(nMapID)
	print("[Function Stack] - DungeonGlobalData:CreatePillarNpc(nMapID) - publicdef.lua");

	if nMapID == nil or nMapID < 0 then
		print(">> Error : nMapID is invalid!");
		return nil;
	end
	print(">> Debug : nMapID = "..nMapID);

	local nMapIdx = SubWorldID2Idx(nMapID);
	if nMapIdx < 0 then
		print(">> Error : nMapIdx is invalid!");
		return nil;
	end
	print(">> Debug : nMapIdx = "..nMapIdx);

	-- ´´½¨ËÎ·½Öù×Ónpc
	local tbNpcPos  = DungeonGlobalData.tbPillarNpcPos[1];
	local tbNpcInfo = DungeonGlobalData.tbPillarNpcInfo[1];

	local nNpcIdx = AddNpcEx(
		tbNpcInfo[1].nNpcId,
		tbNpcInfo[1].nLevel,
		random(0, 4),
		nMapIdx,
		tbNpcPos[1][1] * 32,
		tbNpcPos[1][2] * 32,
		1,
		tbNpcInfo[1].szName,
		tbNpcInfo[1].nIsBoss
	);

	if nNpcIdx ~= nil and nNpcIdx > 0 then
		-- ÉèÖÃÁÙÊ±ÕóÓª
		SetTmpCamp(1, nNpcIdx);
		-- ÉèÖÃËÀÍö½Å±¾
		SetNpcDeathScript(nNpcIdx, "\\script\\missions\\miniencounter\\npcdeath_songpillar.lua");
	end

	-- ´´½¨½ð·½Öù×Ónpc
	tbNpcPos  = DungeonGlobalData.tbPillarNpcPos[2];
	tbNpcInfo = DungeonGlobalData.tbPillarNpcInfo[2];

	local nNpcIdx = AddNpcEx(
		tbNpcInfo[1].nNpcId,
		tbNpcInfo[1].nLevel,
		random(0, 4),
		nMapIdx,
		tbNpcPos[1][1] * 32,
		tbNpcPos[1][2] * 32,
		1,
		tbNpcInfo[1].szName,
		tbNpcInfo[1].nIsBoss
	);

	if nNpcIdx ~= nil and nNpcIdx > 0 then
		-- ÉèÖÃÁÙÊ±ÕóÓª
		SetTmpCamp(2, nNpcIdx);
		-- ÉèÖÃËÀÍö½Å±¾
		SetNpcDeathScript(nNpcIdx, "\\script\\missions\\miniencounter\\npcdeath_jinpillar.lua");
	end

	-- ´´½¨ÖÐÑëÖù×Ó
	tbNpcPos  = DungeonGlobalData.tbPillarNpcPos[3];
	tbNpcInfo = DungeonGlobalData.tbPillarNpcInfo[3];

	local nNpcIdx = AddNpcEx(
		tbNpcInfo[1].nNpcId,
		tbNpcInfo[1].nLevel,
		random(0, 4),
		nMapIdx,
		tbNpcPos[1][1] * 32,
		tbNpcPos[1][2] * 32,
		1,
		tbNpcInfo[1].szName,
		tbNpcInfo[1].nIsBoss
	);

	if nNpcIdx ~= nil and nNpcIdx > 0 then
		-- ÉèÖÃËÀÍö½Å±¾
		SetNpcDeathScript(nNpcIdx, "\\script\\missions\\miniencounter\\npcdeath_middlepillar.lua");
	end

	return 1;
end

function DungeonGlobalData:CreateFightNpc(nMapID)
	print("[Function Stack] - DungeonGlobalData:CreateFightNpc(nMapID) - publicdef.lua");
	print(">> Debug : nMapID = "..nMapID);
	
	local nMapIdx = SubWorldID2Idx(nMapID);
	if nMapIdx < 0 then
		return nil;
	end
	print(">> Debug : nMapIdx = "..nMapIdx);

	-- ´´½¨ËÎ·½npc
	local tbNpcPos  = DungeonGlobalData.tbFightNpcPos[1];
	local tbNpcInfo = DungeonGlobalData.tbFightNpcInfo[1];
	local rtotal = 10000000;
	local i = 1;
	local j = 1;

	for i = 1, getn(tbNpcPos) do
		-- Ëæ»ú
		local rcur  = random(1, rtotal);
		local rstep = 0;

		for j = 1, getn(tbNpcInfo) do
			rstep = rstep + floor(tbNpcInfo[j].nRate * rtotal / 100);
			if(rcur <= rstep) then
				local nNpcIdx = AddNpcEx(
					tbNpcInfo[j].nNpcId,
					tbNpcInfo[j].nLevel,
					random(0, 4),
					nMapIdx,
					tbNpcPos[i][1] * 32,
					tbNpcPos[i][2] * 32,
					1,
					tbNpcInfo[j].szName,
					tbNpcInfo[j].nIsBoss
				);
				
				if nNpcIdx ~= nil and nNpcIdx > 0 then
					-- ÉèÖÃÁÙÊ±ÕóÓª
					SetTmpCamp(1, nNpcIdx);
					-- ÉèÖÃËÀÍö½Å±¾
					SetNpcDeathScript(nNpcIdx, "\\script\\missions\\miniencounter\\npcdeath_songsoldier.lua");
				end

				break;
			end
		end
	end

	-- ´´½¨½ð·½npc
	tbNpcPos  = DungeonGlobalData.tbFightNpcPos[2];
	tbNpcInfo = DungeonGlobalData.tbFightNpcInfo[2];

	for i = 1, getn(tbNpcPos) do
		-- Ëæ»ú
		local rcur  = random(1, rtotal);
		local rstep = 0;

		for j = 1, getn(tbNpcInfo) do
			rstep = rstep + floor(tbNpcInfo[j].nRate * rtotal / 100);
			if(rcur <= rstep) then
				local nNpcIdx = AddNpcEx(
					tbNpcInfo[j].nNpcId,
					tbNpcInfo[j].nLevel,
					random(0, 4),
					nMapIdx,
					tbNpcPos[i][1] * 32,
					tbNpcPos[i][2] * 32,
					1,
					tbNpcInfo[j].szName,
					tbNpcInfo[j].nIsBoss
				);
				
				if nNpcIdx ~= nil and nNpcIdx > 0 then
					-- ÉèÖÃÁÙÊ±ÕóÓª
					SetTmpCamp(2, nNpcIdx);
					-- ÉèÖÃËÀÍö½Å±¾
					SetNpcDeathScript(nNpcIdx, "\\script\\missions\\miniencounter\\npcdeath_jinsoldier.lua");
				end

				break;
			end
		end
	end

	return 1;
end

function DungeonGlobalData:CheckActivityTime()					  -- ¼ì²éÊÇ·ñÔÚÕ½ÒÛ¿ªÆôÊ±¼ä
	local nCurTime = tonumber(GetLocalDate("%H"));
	for i = 1, getn(DungeonGlobalData.tbActivityTime) do
		if self.tbActivityTime[i] ~= nil		 and
		   nCurTime <= self.tbActivityTime[i][2] and 
		   nCurTime >= self.tbActivityTime[i][1] then
			return 1;
		end
	end

	return nil;
end

function DungeonGlobalData:CheckLegalPrepareMap(nCurMapID)		  -- ¼ì²é²ÎÕ½ºÏ·¨µØÍ¼
	if nCurMapID == nil then
		return nil;
	end

	if self.tbLegalPrepareMapList[nCurMapID] ~= nil then
		return 1;
	end

	return nil;
end

