
-- ¸÷µØÍ¼Èë¿ÚµãË÷Òý±í
-- Edited by peres

-- ±í¸ñµÄ¸ñÊ½Îª£º{µØÍ¼±àºÅ, µØÍ¼Ãû³Æ, µØÍ¼´«Èë X Öá, µØÍ¼´«Èë Y  Öá}
-- PS£º×öÍêÕâÕÅ±íÎÒÒª»èÁË¡­¡­



TL_MAPTRAPINDEX = {

	{1,  "Ph­îng T­êng",  1528,  2733},
	{2,  "Hoa S¬n",  2287,  4092},
	{3,  "T©y B¾c KiÕm C¸c Thôc §¹o",  932,  4076},
	{4,  "KiÕm C¸c Thôc §¹o Kim Quang ®éng",  1797,  3058},
	{5,  "Kinh Hoµng ®éng KiÕm C¸c Thôc §¹o",  1822,  3473},
	{6,  "KiÕm C¸c Thôc §¹o Táa V©n ®éng",  1384,  3286},
	{7,  "§Þa BiÓu TÇn L¨ng",  2417,  2631},
	{8,  "tÇng 1 TÇn L¨ng",  1603,  3497},
	{9,  "Tr­êng Giang Nguyªn §Çu",  2478,  5691},
	{10,  "Nh¹n Th¹ch ®éng",  1603,  3209},
	{11,  "Thµnh §«",  3100,  4822},
	{12,  "§Þa ®¹o hËu viÖn TÝn T­íng tù",  1589,  3188},
	{13,  "Nga My ph¸i",  1867,  5021},
	{14,  "M·nh Hæ ®éng",  1589,  3217},
	{15,  "Gi¶ng Kinh §­êng",  1588,  3200},
	{16,  "Nga Mi TiÒn ®iÖn",  1595,  3180},
	{17,  "Nga Mi ChÝnh ®iÖn",  1592,  3211},
	{18,  "Nga Mi Ph¸i T¶ Thiªn §iÖn",  1608,  3191},
	{19,  "T©y Nam KiÕm C¸c Thôc §¹o",  3486,  4070},
	{20,  "Giang T©n Th«n",  3701,  6232},
	{21,  "Thanh Thµnh S¬n",  2247,  3923},
	{22,  "B¹ch V©n ®éng",  1752,  3372},
	{23,  "ThÇn Tiªn ®éng",  1710,  3077},
	{24,  "H­ëng Thñy ®éng",  1692,  3189},
	{25,  "§­êng M«n",  3532,  5770},
	{26,  "Tróc T¬ ®éng tÇng 1",  1603,  3210},
	{27,  "Tróc T¬ ®éng tÇng 2",  1607,  3208},
	{28,  "Tróc T¬ ®éng tÇng 3",  1551,  3192},
	{29,  "§­êng M«n ¸m KhÝ Phßng",  1604,  3201},
	{30,  "§­êng M«n Háa KhÝ Phßng",  1597,  3205},
	{31,  "§­êng M«n Vâ C«ng Phßng",  1610,  3209},
	{32,  "§­êng M«n Y D­îc Phßng",  1595,  3205},
	{33,  "§­êng M«n §¹i S¶nh",  1596,  3213},
	{34,  "§­êng M«n NghÞ Sù phßng",  1599,  3211},
	{35,  "§­êng M«n ChÝnh Phßng",  1598,  3208},
	{36,  "§­êng M«n TÕ Tæ ®­êng",  1592,  3193},
	{37,  "BiÖn Kinh",  2081,  2477},
	{38,  "tÇng 1 Mª cung ThiÕt th¸p ",  1702,  3134},
	{39,  "tÇng 2 Mª cung ThiÕt th¸p",  1690,  3032},
	{40,  "tÇng 3 Mª cung ThiÕt th¸p",  1668,  3133},
	{41,  "Phôc Ng­u S¬n T©y",  2078,  2804},
	{42,  "Thiªn T©m ®éng",  1648,  3119},
	{43,  "KiÕm C¸c Trung Nguyªn",  1673,  2713},
	{45,  "Thiªn NhÉn Gi¸o",  1559,  3246},
	{46,  "Thiªn NhÉn Gi¸o Néi ThÊt",  1611,  3201},
	{47,  "Thiªn NhÉn Gi¸o Néi ThÊt T¶ ",  1606,  3054},
	{48,  "Thiªn NhÉn Gi¸o Néi ThÊt H÷u",  1672,  3138},
	{49,  "Thiªn NhÉn Gi¸o Néi ThÊt",  1608,  3192},
	{50,  "ThÊt S¸t ®éng",  1425,  3217},
	{51,  "Thiªn NhÉn gi¸o Th¸nh ®éng",  1666,  3291},
	{52,  "Thiªn NhÉn gi¸o Th¸nh ®éng",  1617,  3261},
	{53,  "Ba L¨ng huyÖn",  1342,  3346},
	{54,  "Nam Nh¹c trÊn",  1618,  2969},
	{55,  "§µo Hoa Nguyªn",  1729,  3282},
	{56,  "Hoµnh S¬n",  1594,  3210},
	{57,  "Hoµnh S¬n ®¹i ®×nh",  1586,  3202},
	{58,  "§éc C« KiÕm Ngäa thÊt",  1608,  3192},
	{59,  "Thiªn V­¬ng Bang",  1425,  3472},
	{60,  "Thiªn V­¬ng Bang ",  1594,  3193},
	{61,  "Thiªn V­¬ng §¹i ®iÖn",  1591,  3204},
	{62,  "Thiªn V­¬ng §¹i ®iÖn",  1611,  3202},
	{65,  "Thiªn V­¬ng ®¶o s¬n ®éng",  1596,  3250},
	{66,  "D­íi ®¸y §éng §×nh Hå ",  1596,  3199},
	{67,  "D­íi ®¸y §éng §×nh Hå ",  1591,  3193},
	{68,  "Thanh Loa ®¶o",  1545,  2972},
	{69,  "Thanh Loa ®¶o s¬n ®éng",  1600,  3207},
	{70,  "Vò L¨ng s¬n",  1649,  3050},
	{71,  "B¹ch Thñy ®éng",  1739,  3208},
	{72,  "§¹i Tï ®éng",  1611,  2969},
	{73,  "Phôc L­u ®éng",  1599,  3210},
	{74,  "ThÇn N«ng gi¸ ",  1947,  3120},
	{75,  "Kho¶ Lang ®éng",  1872,  3071},
	{76,  "S¬n B¶o ®éng",  1796,  2959},
	{77,  "YÕn Tö ®éng",  1549,  3169},
	{78,  "T­¬ng D­¬ng",  1299,  3483},
	{79,  "T­¬ng D­¬ng mËt ®¹o",  1599,  3206},
	{80,  "D­¬ng Ch©u",  1345,  3359},
	{81,  "Vâ §ang ph¸i",  1620,  3595},
	{82,  "Mª cung ®¸y giÕng Vâ §ang ph¸i",  1593,  3193},
	{83,  "Vâ §ang ph¸i Háa Lang ®éng",  1584,  3248},
	{84,  "Tö Tiªu §¹i §iÖn Vâ §ang ph¸i",  1590,  3193},
	{85,  "ThËp Ph­¬ng §iÖn Vâ §ang ph¸i",  1597,  3192},
	{86,  "Phô MÉu §iÖn Vâ §ang ph¸i ",  1606,  3191},
	{87,  "Long Hæ §iÖn Vâ §ang ph¸i",  1596,  3190},
	{90,  "Phôc Ng­u S¬n §«ng",  1649,  3567},
	{91,  "Kª Qu¸n ®éng",  1806,  2858},
	{92,  "Thôc C­¬ng s¬n",  2025,  3040},
	{93,  "TiÕn Cóc ®éng",  1526,  3172},
	{94,  "Linh Cèc ®éng",  1751,  3107},
	{96,  "T©n Thñ kh¸ch c¬",  1583,  3217},
	{98,  "Thanh khª ®éng",  1526,  2958},
	{99,  "VÜnh L¹c trÊn",  1849,  2835},
	{100,  "Chu Tiªn trÊn",  1852,  3356},
	{101,  "§¹o H­¬ng th«n",  1767,  2816},
	{102,  "Th¸nh ®éng tÇng 2",  1608,  3199},
	{103,  "ThiÕu L©m ph¸i",  1622,  3565},
	{104,  "Tµng Kinh C¸c",  1592,  3190},
	{105,  "§¹t Ma §­êng",  1601,  3190},
	{106,  "§¹i Hïng b¶o ®iÖn",  1591,  3204},
	{107,  "phßng §Ö tö 1",  1593,  3178},
	{108,  "phßng §Ö tö 2",  1596,  3182},
	{109,  "Ph­¬ng tr­îng ThiÒn phßng",  1596,  3185},
	{110,  "La H¸n §­êng",  1606,  3199},
	{111,  "Méc Nh©n H¹ng",  1580,  3417},
	{112,  "Thiªn PhËt ®iÖn",  1601,  3193},
	{113,  "MËt thÊt ThiÕu L©m",  1675,  3361},
	{114,  "108 La H¸n trËn",  1499,  3312},
	{115,  "C¸i Bang",  1538,  4021},
	{116,  "tÇng 1 lßng ®Êt",  1787,  2980},
	{117,  "tÇng 2 lßng ®Êt",  1660,  2947},
	{118,  "tÇng 3 lßng ®Êt",  1525,  2962},
	{119,  "tÇng 4 lßng ®Êt",  1569,  3099},
	{120,  "tÇng 5 lßng ®Êt",  1815,  3195},
	{121,  "Long M«n trÊn",  1715,  4394},
	{122,  "Hoµng Hµ Nguyªn §Çu",  1612,  3328},
	{123,  "L·o Hæ ®éng",  1698,  3363},
	{124,  "C¸n Viªn ®éng",  1672,  3420},
	{125,  "L­u Tiªn ®éng tÇng 1",  1811,  3219},
	{126,  "L­u Tiªn ®éng tÇng 2",  1496,  2929},
	{127,  "L­u Tiªn ®éng tÇng 3",  1769,  3216},
	{128,  "L­u Tiªn ®éng tÇng 4",  1515,  3123},
	{129,  "L­u Tiªn ®éng tÇng 5",  1597,  3212},
	{130,  "L­u Tiªn ®éng tÇng 6",  1547,  3143},
	{131,  "C«n L«n ph¸i",  1872,  3659},
	{132,  "B¨ng HuyÖt ®éng ",  1701,  3407},
	{135,  "KiÕn TÝnh Phong s¬n ®éng",  1748,  3198},
	{136,  "Kho¸i Ho¹t L©m",  1716,  3144},
	{137,  "Thiªn Vi ®iÖn",  1603,  3202},
	{138,  "C«n L«n ph¸i ChÝnh ®iÖn",  1604,  3203},
	{139,  "Tö Vi ®iÖn",  1612,  3207},
	{140,  "D­îc V­¬ng Cèc",  2429,  3731},
	{141,  "D­îc V­¬ng ®éng tÇng 1",  1603,  3372},
	{142,  "D­îc V­¬ng ®éng tÇng 2",  1467,  3288},
	{143,  "D­îc V­¬ng ®éng tÇng 3",  1602,  3215},
	{144,  "D­îc V­¬ng ®éng tÇng 4",  1690,  3023},
	{145,  "TuyÕt B¸o ®éng tÇng 1",  1563,  3245},
	{146,  "TuyÕt B¸o ®éng tÇng 2",  1630,  3325},
	{147,  "TuyÕt B¸o ®éng tÇng 3",  1630,  3323},
	{148,  "TuyÕt B¸o ®éng tÇng 4",  1527,  3273},
	{149,  "TuyÕt B¸o ®éng tÇng 5",  1611,  3220},
	{150,  "TuyÕt B¸o ®éng tÇng 6",  1613,  3184},
	{151,  "TuyÕt B¸o ®éng tÇng 7",  1612,  3218},
	{152,  "TuyÕt B¸o ®éng tÇng 8",  1675,  3365},
	{153,  "Th¹ch Cæ trÊn",  1439,  3042},
	{154,  "Thóy Yªn m«n",  628,  1261},
	{155,  "Thóy Yªn M«n B¸ch Hoa ®×nh",  1585,  3207},
	{156,  "Thóy Yªn M«n phßng §Ö tö 1",  1599,  3203},
	{157,  "Thóy Yªn M«n phßng §Ö tö 2",  1587,  3221},
	{158,  "Thóy Yªn M«n CÊm §Þa mª cung",  1584,  3191},
	{160,  "Thóy Yªn M«n Thñ Ngäc s¶nh",  1596,  3208},
	{161,  "Thóy Yªn M«n Chñ phßng",  1600,  3202},
	{162,  "§¹i Lý",  1642,  2935},
	{163,  "¸c b¸ ®Þa ®¹o",  1559,  3201},
	{164,  "Thiªn TÇm th¸p tÇng 1",  1606,  3194},
	{165,  "Thiªn TÇm th¸p tÇng 2",  1501,  3295},
	{166,  "Thiªn TÇm th¸p tÇng 3",  1662,  3245},
	{167,  "§iÓm Th­¬ng s¬n",  1214,  2731},
	{168,  "Phông Nh·n ®éng",  1508,  3005},
	{169,  "Long Nh·n ®éng",  1596,  3212},
	{170,  "Thæ PhØ ®éng",  1605,  3191},
	{171,  "§iÓm Th­¬ng ®éng tÇng 1",  1532,  3130},
	{172,  "§iÓm Th­¬ng ®éng tÇng 2",  1586,  3223},
	{173,  "§iÓm Th­¬ng ®éng tÇng 3",  1353,  3102},
	{174,  "Long TuyÒn th«n",  1818,  3017},
	{175,  "T©y S¬n th«n",  1595,  3240},
	{176,  "L©m An",  1614,  2561},
	{177,  "Ngù Hoa viªn",  1619,  3222},
	{178,  "S¬n ®éng Ngù Hoa viªn",  1609,  3200},
	{179,  "La Tiªu s¬n",  1618,  3292},
	{180,  "Long Cung ®éng",  1509,  3106},
	{181,  "L­ìng Thñy ®éng",  1590,  3199},
	{182,  "NghiÖt Long ®éng",  1997,  3067},
	{183,  "Ngò §éc Gi¸o",  1371,  3677},
	{184,  "XÝch YÕt tr¹i",  1590,  3208},
	{185,  "Kim Xµ tr¹i",  1612,  3204},
	{186,  "MÆc Thï tr¹i",  1613,  3210},
	{187,  "Thanh Ng« tr¹i",  1605,  3200},
	{188,  "Ng©n ThiÒm tr¹i",  1587,  3205},
	{189,  "Tæng tr¹i",  1581,  3194},
	{190,  "Ngò §éc Gi¸o Mª cung nhËp m«n",  1380,  3003},
	{193,  "Vò Di s¬n",  1937,  2851},
	{194,  "Ngäc Hoa ®éng",  1599,  3199},
	{195,  "Nh¹n §·ng s¬n",  682,  2863},
	{196,  "D­¬ng Gi¸c ®éng",  1691,  3068},
	{198,  "Thanh khª ®éng",  1522,  2955},
	{199,  "Vò L¨ng ®éng",  1644,  2906},
	{200,  "Cæ D­¬ng ®éng",  1612,  3171},
	{201,  "B¨ng Hµ ®éng",  1599,  3197},
	{202,  "Phï Dung ®éng",  1786,  2823},
	{203,  "V« Danh ®éng",  1551,  2992},
	{204,  "Phi Thiªn ®éng",  1679,  3391},
	{205,  "D­¬ng Trung ®éng",  1698,  3408},
	{206,  "TÇn L¨ng tÇng 2",  1790,  3265},
	{207,  "TÇn L¨ng tÇng 3",  1595,  3205},
	{224,  "Sa m¹c §Þa biÓu",  1591,  3013},
	{225,  "S¬n ®éng Sa m¹c tÇng 1",  1476,  3274},
	{226,  "S¬n ®éng Sa m¹c tÇng 2",  1553,  3173},
	{227,  "S¬n ®éng Sa m¹c tÇng 3",  1530,  3270},
	{231,  "N¬i ë Th­¬ng L­¬ng kh¸ch",  1611,  3193},
	{319,  "L©m Du Quan",  2031,  3286},
	{320,  "Ch©n nói Tr­êng B¹ch",  1386,  2253},
	{321,  "Tr­êng B¹ch s¬n Nam ",  966,  2296},
	{322,  "Tr­êng B¹ch s¬n B¾c",  2048,  4120},
	{340,  "M¹c Cao QuËt",  1853,  3446}
}


-- ´«Èë²ÎÊýÎªÏëÒªËÑÑ°µÄµØÍ¼ ID ºÅ
-- ·µ»ØÖµÎªµØÍ¼µÄÃû³Æ¡¢Èë¿Ú X Öá×ø±ê¡¢Èë¿Ú Y Öá×ø±ê

function tl_getMapInfo(myMapID)

local i

	for i=1, getn(TL_MAPTRAPINDEX) do
		if (TL_MAPTRAPINDEX[i][1] == myMapID) then
			return TL_MAPTRAPINDEX[i][2], TL_MAPTRAPINDEX[i][3], TL_MAPTRAPINDEX[i][4]
		end
	end

return 0,0,0 -- Èç¹ûÔÚ±íÖÐÃ»ÕÒµ½ÏàÓ¦µÄµØÍ¼Ôò·µ»Ø 0

end


-- ´«ËÍÈËÎïµ½ÈÎÎñÖ¸¶¨µÄµØÍ¼

function tl_moveToTaskMap()

local myMapID, myMapName, myMapX, myMapY

	myMapID = GetTask(1031)
			
	myMapName, myMapX, myMapY = tl_getMapInfo(myMapID)
			
	if (myMapName ~= 0) then
		Say("Kh¸ch quan muèn ®Õn khu vùc lµm nhiÖm D· TÈu ".."<color=yellow>"..myMapName.."<color>".."­? Ta sÏ ®­a ®i miÔn phÝ!",2,"§óng vËy! Mau ®­a ta ®i!/tl_moveToTaskMap_Confirm","Th«i khái! Ta cßn viÖc kh¸c!/tl_moveToTaskMap_Cancel");
	else
		Say("Xin lçi! N¬i quý kh¸ch muèn ®Õn qu¸ hiÓm trë! Hay lµ tù ®i vËy!",0);
	end

end


function tl_moveToTaskMap_Confirm()

local nResult

local myMapID, myMapName, myMapX, myMapY

	myMapID = GetTask(1031)
			
	myMapName, myMapX, myMapY = tl_getMapInfo(myMapID)

	nResult = NewWorld(myMapID, myMapX, myMapY)
	
	SetFightState(1)
	
	if (nResult == 0) then
		SetFightState(0)
		Msg2Player("Xin lçi! HiÖn vÉn ch­a chuyÓn ®i!");
		return
	end
	
end


function tl_moveToTaskMap_Cancel()

end